# 基于以太坊构建联盟链

PoA Chain特点：

- 有别于PoW，PoA是依靠预设好的Authority nodes，负责产生block。
- 可依靠需求设定Authority node数量。
- 可指定产生block的时间，例如交易收到交易的5秒后产生block。
- 一般的Ethereum node也可以连接到PoA Chain，正常发起transaction，contracts等。

### 下载安装parity

	sudo dpkg -i  parity_1.9.5_ubuntu_amd64.deb

### PoA 创建创世区块

	{
	  "name": "DemoPoA",
	  "engine": {
	    "authorityRound": {
	      "params": {
	        "stepDuration": "5",
	        "validators": {
	          "list": [
	            
	          ]
	        }
	      }
	    }
	  },
	  "params": {
	    "gasLimitBoundDivisor": "0x0400",
	    "maximumExtraDataSize": "0x20",
	    "minGasLimit": "0x1388",
	    "networkID": "0x2323"
	  },
	  "genesis": {
	    "seal": {
	      "authorityRound": {
	        "step": "0x0",
	        "signature": "0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
	      }
	    },
	    "difficulty": "0x20000",
	    "gasLimit": "0x5B8D80"
	  },
	  "accounts": {
	    "0x0000000000000000000000000000000000000001": {
	      "balance": "1",
	      "builtin": {
	        "name": "ecrecover",
	        "pricing": {
	          "linear": {
	            "base": 3000,
	            "word": 0
	          }
	        }
	      }
	    },
	    "0x0000000000000000000000000000000000000002": {
	      "balance": "1",
	      "builtin": {
	        "name": "sha256",
	        "pricing": {
	          "linear": {
	            "base": 60,
	            "word": 12
	          }
	        }
	      }
	    },
	    "0x0000000000000000000000000000000000000003": {
	      "balance": "1",
	      "builtin": {
	        "name": "ripemd160",
	        "pricing": {
	          "linear": {
	            "base": 600,
	            "word": 120
	          }
	        }
	      }
	    },
	    "0x0000000000000000000000000000000000000004": {
	      "balance": "1",
	      "builtin": {
	        "name": "identity",
	        "pricing": {
	          "linear": {
	            "base": 15,
	            "word": 3
	          }
	        }
	      }
	    }
	  }
	}

创建创世区块：

- stepDuration 设定成5秒产生一个区块
- validators设定Authority的地方，目前空着，后面创建account之后再回来填入

将上面的文件保存为gen-spec.json

### 设置两个节点

建立两个文件node0.toml和node1.toml

- base_path:指定存储资料与帐号的目录
- [network] port:指定Parity的network port，让其他node连接
- [rpc] port:这是RPC port,是哦那个web3.js时会需要
- [ui] port：Parity提供的web-based UI port

node0使用如下配置：

	[parity]
	chain = "gen-spec.json"
	base_path = "parity0"
	[network]
	port = 30300
	[rpc]
	port = 8540
	apis = ["web3", "eth", "net", "personal", "parity", "parity_set", "traces", "rpc", "parity_accounts"]
	interface = "0.0.0.0"
	cors = ["*"]
	[ui]
	force = false
	disable = false
	interface = "10.0.3.15"
	port = 8180
	hosts = ["all"]
	[websockets]
	port = 8456


node1使用如下配置：

	[parity]
	chain = "gen-spec.json"
	base_path = "parity1"
	[network]
	port = 30301
	[rpc]
	port = 8541
	apis = ["web3", "eth", "net", "personal", "parity", "parity_set", "traces", "rpc", "parity_accounts"]
	interface = "0.0.0.0"
	cors = ["*"]
	[ui]
	force = false
	disable = false
	interface = "10.0.3.15"
	port = 8181
	hosts = ["all"]
	[websockets]
	port = 8457

启动节点：

	parity --config node0.toml
	parity --config node1.toml

### 设置帐号

